(()=>{var e={};e.id=542,e.ids=[542,558],e.modules={62849:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=62849,e.exports=r},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},524:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},98216:e=>{"use strict";e.exports=require("net")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},95346:e=>{"use strict";e.exports=require("timers")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},90527:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>_,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{GET:()=>p});var o=t(49303),u=t(88716),i=t(60670),n=t(87070),a=t(75748),c=t(95456);async function p(e){try{let r=e.headers.get("authorization");if(!r||!r.startsWith("Bearer "))return n.NextResponse.json({error:"Unauthorized"},{status:401});let t=r.substring(7),s=(0,c.verifyToken)(t);if(!s||"customer"!==s.role)return n.NextResponse.json({error:"Unauthorized"},{status:401});let o=(0,a.M)(),u=s.id,[i]=await o.execute(`SELECT 
        o.*,
        COUNT(oi.id) as item_count
      FROM orders o
      LEFT JOIN order_items oi ON o.id = oi.order_id
      WHERE o.user_id = ?
      GROUP BY o.id
      ORDER BY o.created_at DESC`,[u]),p=i.map(e=>({id:e.id,orderNumber:e.order_number,customerName:e.customer_name,customerEmail:e.customer_email,customerPhone:e.customer_phone,shippingAddress:e.shipping_address,totalAmount:parseFloat(e.total_amount),status:e.status,paymentMethod:e.payment_method,paymentStatus:e.payment_status,itemCount:e.item_count,createdAt:e.created_at,updatedAt:e.updated_at}));return n.NextResponse.json({orders:p})}catch(e){return console.error("Error fetching customer orders:",e),n.NextResponse.json({error:"Failed to fetch orders",message:e.message},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/orders/customer/route",pathname:"/api/orders/customer",filename:"route",bundlePath:"app/api/orders/customer/route"},resolvedPagePath:"E:\\amertrading.shop\\src\\app\\api\\orders\\customer\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:h}=d,x="/api/orders/customer/route";function _(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:l})}},95456:(e,r,t)=>{"use strict";t.d(r,{Oe:()=>a,RA:()=>c,c_:()=>n,verifyToken:()=>p});var s=t(98691),o=t(41482),u=t.n(o);let i=process.env.JWT_SECRET||"your-secret-key-change-in-production";function n(e){return s.ZP.hashSync(e,10)}function a(e,r){return s.ZP.compareSync(e,r)}function c(e){return u().sign(e,i,{expiresIn:"7d"})}function p(e){try{return u().verify(e,i)}catch{return null}}},75748:(e,r,t)=>{"use strict";t.d(r,{M:()=>u});var s=t(73785);let o=null;function u(){return o||(o=s.createPool({host:process.env.DB_HOST||"localhost",user:process.env.DB_USER||"root",password:process.env.DB_PASSWORD||"",database:process.env.DB_NAME||"amer_shop",waitForConnections:!0,connectionLimit:10,queueLimit:0})),o}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,785,86],()=>t(90527));module.exports=s})();